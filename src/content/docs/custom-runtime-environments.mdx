import ScrollLink from "../../components/ScrollLink"

A runtime plugin is a function that can run process chain <ScrollLink href="#executables">executables</ScrollLink>
inside a certain runtime environment. See the `runtime` property
of <ScrollLink href="#service-metadata">service metadata</ScrollLink>.

The plugin's function takes an executable to run and the number of lines to
collect from the executable's output. It returns the output generated by the
executable (trimmed down to given number of lines). If required, the function
can be a suspend function.

Use this plugin if you want to implement a special way to execute processing
services. For example, you can implement a remote web service call, you
can use one of the existing runtimes and run a certain service in a special
way (like in the example plugin below), etc.


| Type |
| ---- |

`runtime`

| Additional properties               |
| ----------------------------------- | ----------------
| supportedRuntime<br />*(required)*  | The name of the `runtime` this plugin provides. Use this value in your service metadata.

| Function interface |
| ------------------ |

```kotlin
suspend fun myRuntime(executable: model.processchain.Executable,
  outputLinesToCollect: Int, vertx: io.vertx.core.Vertx): String
```

| Example descriptor ([Source](https://github.com/steep-wms/steep-montage/blob/master/conf/plugins/montage.yaml)) |
| ------------------ |

```yaml
- name: ignoreDiffFitError
  type: runtime
  scriptFile: conf/plugins/ignoreDiffFitError.kts
  supportedRuntime: ignoreDiffFitError
```

| Example plugin script ([Source](https://github.com/steep-wms/steep-montage/blob/master/conf/plugins/ignoreDiffFitError.kts)) |
| --------------------- |

```kotlin
import helper.Shell.ExecutionException
import io.vertx.core.Vertx
import model.processchain.Executable
import runtime.OtherRuntime

fun ignoreDiffFitError(executable: Executable, outputLinesToCollect: Int, vertx: Vertx): String {
  return try {
    OtherRuntime().execute(executable, outputLinesToCollect)
  } catch (e: ExecutionException) {
    // ignore invalid exit code of the mDiffFit service
    if (e.exitCode == 1) {
      ""
    } else {
      throw e
    }
  }
}
```
